{"version":3,"sources":["lib/util/Observable.js"],"names":[],"mappings":"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","file":"lib/util/Observable.js","sourcesContent":["'use babel';\r\n'use strict';\r\n\r\nclass Observable {\r\n\tconstructor (cfg) {\r\n\t\tcfg = cfg || {};\r\n\t\t//eventType -> array of listener functions\r\n\t\tthis.eventListeners = {};\r\n\t\tthis.context = cfg.context || this;\r\n\t\tthis.ignoreErrors = ('ignoreErrors' in cfg) ? cfg.ignoreErrors : false;\r\n\r\n\t\tif (cfg.listeners) {\r\n\t\t\tthis.on(cfg.listeners);\r\n\t\t}\r\n\r\n\t\tthis.once = this.one.bind(this);\r\n\r\n\t}\r\n\ton (eventType, listener) {\r\n\t\tvar subscribers;\r\n\r\n\t\tif(arguments.length === 1) {\r\n\t\t\tlet callbacks = arguments[0];\r\n\t\t\tfor (let eventKey in callbacks) {\r\n\t\t\t\tthis.on(eventKey, callbacks[eventKey]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsubscribers = this.eventListeners[eventType];\r\n\t\t\tif (!subscribers) {\r\n\t\t\t\tsubscribers = this.eventListeners[eventType] = new Set();\r\n\t\t\t}\r\n\t\t\tsubscribers.add(listener);\r\n\t\t}\r\n\t}\r\n\tone (eventType, listener) {\r\n\t\tif(arguments.length === 1) {\r\n\t\t\tlet callbacks = arguments[0];\r\n\t\t\tfor (let eventKey in callbacks) {\r\n\t\t\t\tthis.one.call(this, eventKey, callbacks[eventKey]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// will be called in this.context\r\n\t\t\tlet wrapper = (...args) => {\r\n\t\t\t\tthis.off.call(this, eventType, wrapper);\r\n\t\t\t\tlistener.apply(this, args);\r\n\t\t\t};\r\n\t\t\tthis.on.call(this, eventType, wrapper);\r\n\t\t}\r\n\t}\r\n\tonce () { return this.one.apply(this, arguments); }\r\n\r\n\tmon ($scope, eventType, listener) {\r\n\t\tif(arguments.length === 2){\r\n\t\t\targuments[1].forEach( (l, e) => {\r\n\t\t\t\tthis.mon($scope, e, l);\r\n\t\t\t});\r\n\t\t}\telse {\r\n\t\t\tthis.on(eventType, listener);\r\n\t\t\t$scope.$on('$destroy', this.off.bind(this, eventType, listener));\r\n\t\t}\r\n\t}\r\n\r\n\toff (eventType, listener) {\r\n\t\tvar subscribers = this.eventListeners[eventType];\r\n\t\tif (subscribers) {\r\n\t\t\tsubscribers.delete(listener);\r\n\r\n\t\t\tif (!subscribers.size) {\r\n\t\t\t\tdelete this.eventListeners[eventType];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\toffAll (eventType) {\r\n\t\tvar subscribers = this.eventListeners[eventType];\r\n\t\tif (subscribers) { subscribers.clear(); }\r\n\t\tdelete this.eventListeners[eventType];\r\n\t}\r\n\r\n\tonAny (listener) { return this.on.call(this, '*', listener); }\r\n\toneAny (listener) { return this.one.call(this, '*', listener); }\r\n\tonceAny (listener) { return this.oneAny.call(this, listener); }\r\n\toffAny (listener) { return this.off.call(this, '*', listener); }\r\n\r\n\thasListeners () {\r\n\t\treturn !!Object.keys(this.eventListeners);\r\n\t}\r\n\r\n\t// renamed from fire to match node EventEmitter convention\r\n\temit (eventType, ...args) {\r\n\t\tvar subscribers = this.eventListeners[eventType],\r\n\t\t\t\tallEventSubscribers = this.eventListeners['*'];\r\n\r\n\t\tif (allEventSubscribers) {\r\n\t\t\tlet allArgs = arguments;\r\n\t\t\tallEventSubscribers.forEach( (l) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tl.apply(this.context, allArgs);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tif (!this.ignoreErrors) { throw err; }\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (subscribers) {\r\n\t\t\tsubscribers.forEach( (l) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tl.apply(this.context, args);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tif (!this.ignoreErrors) { throw err; }\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = Observable;\r\n"]}