{"version":3,"sources":["lib/util/TimeUtil.js"],"names":[],"mappings":"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","file":"lib/util/TimeUtil.js","sourcesContent":["'use strict';\r\n\r\nvar _ = require('lodash');\r\n\r\nvar TimeUtil = {\r\n\r\n\t//Utility function to parse an ISO-8601 formatted date/time string\r\n\t/**\r\n\t\tInput: string. Example: 2013-03-31T04:11:08.860Z\r\n\t\tReturns: a date object\r\n\t*/\r\n\tparseUTCDate: function(string) {\r\n\t\tvar R_ISO8601_STR = /^(\\d{4})-?(\\d\\d)-?(\\d\\d)(?:T(\\d\\d)(?::?(\\d\\d)(?::?(\\d\\d)(?:(\\.\\d+))?)?)?(Z|([+-])(\\d\\d):?(\\d\\d))?)?$/;\r\n\t\t                    // 1        2       3         4          5          6          7          8  9     10      11\r\n\t\tif(!string){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif(string instanceof Date){\r\n\t\t\treturn string;\r\n\t\t}\r\n\r\n\t\tvar match = string.match(R_ISO8601_STR);\r\n\t\tif (match) {\r\n\t\t\tvar date = new Date(0),\r\n\t\t\t\t\ttzHour = 0,\r\n\t\t\t\t\ttzMin\t= 0,\r\n\t\t\t\t\tdateSetter = match[8] ? date.setUTCFullYear : date.setFullYear,\r\n\t\t\t\t\ttimeSetter = match[8] ? date.setUTCHours : date.setHours;\r\n\r\n\t\t\tif (match[9]) {\r\n\t\t\t\ttzHour = parseInt(match[9] + match[10],10);\r\n\t\t\t\ttzMin = parseInt(match[9] + match[11],10);\r\n\t\t\t}\r\n\t\t\tvar millis = match[7];\r\n\t\t\tif(millis){ //convert the fractional second into milliseconds\r\n\t\t\t\tmillis = Math.floor( parseFloat(millis, 10) * 1000 );\r\n\t\t\t}\r\n\t\t\tdateSetter.call(date, parseInt(match[1],10), parseInt(match[2],10) - 1, parseInt(match[3],10));\r\n\t\t\ttimeSetter.call(date, parseInt(match[4]||0,10) - tzHour, parseInt(match[5]||0,10) - tzMin, parseInt(match[6]||0, 10), millis);\r\n\t\t\treturn date;\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\t/**\r\n\t\tReturns a length of time in milliseconds\r\n\t**/\r\n\tparseCSharpTimespan: function(timeStr){\r\n\t\tif(typeof timeStr === 'number'){\r\n\t\t\treturn timeStr;\r\n\t\t}\r\n\r\n\t\t//[-][d.]hh:mm:ss[.ffffff]\r\n\t\tvar parts = /^(-)?(\\d*\\.)?(\\d\\d):(\\d\\d):(\\d\\d\\.?\\d*)$/.exec(timeStr);\r\n\t\t            // 1   2      3      4      5\r\n\r\n\t\tif(!parts){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar days = parseInt(parts[2])||0;\r\n\t\tvar hours = parseInt(parts[3])||0;\r\n\t\tvar minutes = parseInt(parts[4])||0;\r\n\t\tvar seconds = parseFloat(parts[5])||0;\r\n\r\n\t\thours += days * 24;\r\n\t\tminutes += hours * 60;\r\n\t\tseconds += minutes * 60;\r\n\t\tvar millis = Math.floor(seconds * 1000);\r\n\t\tif(parts[1] === '-'){\r\n\t\t\tmillis = -millis;\r\n\t\t}\r\n\t\treturn millis;\r\n\t},\r\n\r\n\t//Formats number of milliseconds into a c# timespan string\r\n\tformatCSharpTimespan: function(timespan){\r\n\t\tvar isNegative = timespan < 0;\r\n\t\ttimespan = Math.abs(timespan);\r\n\r\n\t\tvar fractionalSeconds = String((timespan % 1000)/1000);\r\n\r\n\t\tvar t = Math.floor(timespan/1000);\r\n\t\tvar seconds = (t % 60) ;\r\n\t\tvar minutes = Math.floor(t/60)%60;\r\n\t\tvar hours = Math.floor(t/3600)%24;\r\n\t\tvar days = Math.floor(t/86400);\r\n\r\n\t\treturn (isNegative ? '-' : '') +\r\n\t\t\t(days > 0 ? days + '.' : '') +\r\n\t\t\tpad2(hours) + ':' + pad2(minutes) + \":\" + pad2(seconds) +\r\n\t\t\t(fractionalSeconds>0 ? fractionalSeconds.slice(fractionalSeconds.indexOf('.')) : '');\r\n\r\n\t\t//i: a number less than 100\r\n\t\t//returns i formatted with up to two leading zeros -> pad2(1) === '01'\r\n\t\tfunction pad2(i){\r\n\t\t\treturn (\"00\"+i).slice(-2);\r\n\t\t}\r\n\t},\r\n\r\n\tformatTimespan: function(timespan, full){\r\n\t\tif(_.isString(timespan)){\r\n\t\t\ttimespan = +timespan;\r\n\t\t}\r\n\t\tif(isNaN(timespan) || !_.isNumber(timespan) || timespan < 0){\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tvar t = Math.floor(timespan/1000);\r\n\r\n\t\tvar seconds = t%60;\r\n\t\tvar minutes = Math.floor(t/60)%60;\r\n\t\tvar hours = Math.floor(t/3600);\r\n\r\n\t\tif(hours > 0 || full){\r\n\t\t\treturn hours + \":\" + pad2(minutes) + \":\" + pad2(seconds);\r\n\t\t}\r\n\t\telse{\r\n\t\t\treturn pad2(minutes) + \":\" + pad2(seconds);\r\n\t\t}\r\n\r\n\t\t//i: a number less than 100\r\n\t\t//returns a 2-length string - the number with leading zeros\r\n\t\tfunction pad2(i){\r\n\t\t\treturn (\"00\"+i).slice(-2);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t *\r\n\t * @param macAddress\r\n\t * @returns a mac address with all special characters removed\r\n\t */\r\n\tformatMacAddressNumbersOnly: function(macAddress) {\r\n\t\treturn macAddress.replace(/[^0-9a-zA-Z]+/g,'').toUpperCase();\r\n\t},\r\n\r\n};\r\n\r\nmodule.exports = TimeUtil;\r\n"]}